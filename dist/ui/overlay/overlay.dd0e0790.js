import"../window/window.5148fe9c.js";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},t={},s=e.parcelRequire9a9a;null==s&&((s=function(e){if(e in a)return a[e].exports;if(e in t){var s=t[e];delete t[e];var l={id:e,exports:{}};return a[e]=l,s.call(l.exports,l,l.exports),l.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,a){t[e]=a},e.parcelRequire9a9a=s),s.register;var l=s("YgFEM");s("18qrn");var r=s("d677Q"),i=s("3ruKn"),n=s("6r7ZQ"),l=s("YgFEM"),o=s("18qrn"),d=s("jvi9v"),c=s("mKhnF"),u=s("8zbWC");let m=document.getElementById("app");m&&(0,r.createRoot)(m).render((0,l.jsx)(()=>{let[e,a]=(0,o.useState)([]),[t,s]=(0,o.useState)(!0),[r,m]=(0,o.useState)(void 0),[g,h]=(0,o.useState)(""),[p,v]=(0,o.useState)({searchTerm:"",dateRange:{start:"",end:""},tags:[],sortBy:"createdAt",sortDirection:"desc",fileFilter:""}),[f,k]=(0,o.useState)(),[b,x]=(0,o.useState)(!1),j=window,{filteredBookmarks:y,availableTags:E}=(0,u.default)({bookmarks:e,filters:p,parsedQuery:b?f:void 0});(0,o.useEffect)(()=>{var e,t;let s=e=>{let t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){return}(null==t?void 0:t.type)==="BOOKMARKS_UPDATED"&&t.data?a(r?t.data.filter(e=>e.filepath===r):t.data):(null==t?void 0:t.type)==="CURRENT_FILE_PATH"&&t.data&&(m(t.data),a(e=>t.data?e.filter(e=>e.filepath===t.data):e))};return(null==(e=j.iina)?void 0:e.onMessage)?j.iina.onMessage("message",s):window.addEventListener("message",s),(null==(t=j.iina)?void 0:t.postMessage)&&(j.iina.postMessage("UI_READY",{uiType:"overlay"}),j.iina.postMessage("REQUEST_FILE_PATH")),()=>{var e;(null==(e=j.iina)?void 0:e.onMessage)||window.removeEventListener("message",s)}},[r]);let w=e=>{var a,t;null==(t=j.iina)||null==(a=t.postMessage)||a.call(t,"JUMP_TO_BOOKMARK",{id:e})},N=r?y.filter(e=>e.filepath===r):[];return t&&0!==N.length?(0,l.jsxs)("div",{className:"bookmark-overlay",children:[(0,l.jsxs)("div",{className:"bookmark-overlay-header",children:[(0,l.jsxs)("h3",{children:["Bookmarks (",N.length,")"]}),(0,l.jsx)("button",{onClick:()=>{var e,a;null==(a=j.iina)||null==(e=a.postMessage)||e.call(a,"HIDE_OVERLAY"),s(!1)},className:"close-btn","data-clickable":"true",children:"Ã—"})]}),e.filter(e=>e.filepath===r).length>3&&(0,l.jsx)("div",{className:"overlay-search",children:b?(0,l.jsx)(d.default,{onSearchChange:(e,a)=>{k(a),v(a=>(0,n._)((0,i._)({},a),{searchTerm:e,fileFilter:r||""})),h(e)},availableTags:E,placeholder:"Search... (try: tag:work)",className:"overlay-compact"}):(0,l.jsxs)("div",{className:"search-with-toggle",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search bookmarks...",value:g,onChange:e=>{h(e.target.value),v(a=>(0,n._)((0,i._)({},a),{searchTerm:e.target.value,fileFilter:r||""}))},className:"overlay-search-input"}),(0,l.jsx)("button",{onClick:()=>x(!0),className:"advanced-toggle-btn",title:"Enable advanced search",children:"\uD83D\uDD0D+"})]})}),(0,l.jsx)("ul",{className:"bookmark-list",children:N.map(e=>(0,l.jsxs)("li",{className:"bookmark-item",onClick:()=>w(e.id),title:`Click to jump to ${e.title}`,"data-clickable":"true",children:[(0,l.jsx)("span",{className:"bookmark-title",children:(0,l.jsx)(c.default,{text:e.title,searchTerms:g,caseSensitive:!1})}),e.tags&&e.tags.length>0&&(0,l.jsx)("div",{className:"bookmark-tags",children:e.tags.map(e=>(0,l.jsx)("span",{className:"bookmark-tag",children:e},e))}),(0,l.jsx)("span",{className:"bookmark-time",children:new Date(1e3*(e.timestamp||0)).toISOString().substr(11,8)})]},e.id))})]}):null},{}));
//# sourceMappingURL=overlay.dd0e0790.js.map
