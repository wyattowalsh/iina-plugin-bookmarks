!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},t={},n=e.parcelRequire9a9a;null==n&&((n=function(e){if(e in a)return a[e].exports;if(e in t){var n=t[e];delete t[e];var r={id:e,exports:{}};return a[e]=r,n.call(r.exports,r,r.exports),r.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,a){t[e]=a},e.parcelRequire9a9a=n),n.register;var r=n("jr3WH");n("joq15");var s=n("fEatv"),i=n("gDbdG"),l=n("78RNE"),o=n("hiL4o"),r=n("jr3WH"),c=n("joq15"),u=n("blyWw"),d=n("7yYUG"),f=n("3gg67"),g=document.getElementById("app");g&&(0,s.createRoot)(g).render((0,r.jsx)(function(){var e=(0,o._)((0,c.useState)([]),2),a=e[0],t=e[1],n=(0,o._)((0,c.useState)(!0),2),s=n[0],g=n[1],m=(0,o._)((0,c.useState)(void 0),2),h=m[0],v=m[1],p=(0,o._)((0,c.useState)(""),2),k=p[0],b=p[1],x=(0,o._)((0,c.useState)({searchTerm:"",dateRange:{start:"",end:""},tags:[],sortBy:"createdAt",sortDirection:"desc",fileFilter:""}),2),j=x[0],y=x[1],_=(0,o._)((0,c.useState)(),2),N=_[0],E=_[1],S=(0,o._)((0,c.useState)(!1),2),T=S[0],w=S[1],D=window,M=(0,f.default)({bookmarks:a,filters:j,parsedQuery:T?N:void 0}),R=M.filteredBookmarks,O=M.availableTags;(0,c.useEffect)(function(){var e,a,n=function(e){var a=e.data;if("string"==typeof e.data)try{a=JSON.parse(e.data)}catch(e){return}(null==a?void 0:a.type)==="BOOKMARKS_UPDATED"&&a.data?t(h?a.data.filter(function(e){return e.filepath===h}):a.data):(null==a?void 0:a.type)==="CURRENT_FILE_PATH"&&a.data&&(v(a.data),t(function(e){return a.data?e.filter(function(e){return e.filepath===a.data}):e}))};return(null==(e=D.iina)?void 0:e.onMessage)?D.iina.onMessage("message",n):window.addEventListener("message",n),(null==(a=D.iina)?void 0:a.postMessage)&&(D.iina.postMessage("UI_READY",{uiType:"overlay"}),D.iina.postMessage("REQUEST_FILE_PATH")),function(){var e;(null==(e=D.iina)?void 0:e.onMessage)||window.removeEventListener("message",n)}},[h]);var A=function(e){var a,t;null==(t=D.iina)||null==(a=t.postMessage)||a.call(t,"JUMP_TO_BOOKMARK",{id:e})},C=h?R.filter(function(e){return e.filepath===h}):[];return s&&0!==C.length?(0,r.jsxs)("div",{className:"bookmark-overlay",children:[(0,r.jsxs)("div",{className:"bookmark-overlay-header",children:[(0,r.jsxs)("h3",{children:["Bookmarks (",C.length,")"]}),(0,r.jsx)("button",{onClick:function(){var e,a;null==(a=D.iina)||null==(e=a.postMessage)||e.call(a,"HIDE_OVERLAY"),g(!1)},className:"close-btn","data-clickable":"true",children:"Ã—"})]}),a.filter(function(e){return e.filepath===h}).length>3&&(0,r.jsx)("div",{className:"overlay-search",children:T?(0,r.jsx)(u.default,{onSearchChange:function(e,a){E(a),y(function(a){return(0,l._)((0,i._)({},a),{searchTerm:e,fileFilter:h||""})}),b(e)},availableTags:O,placeholder:"Search... (try: tag:work)",className:"overlay-compact"}):(0,r.jsxs)("div",{className:"search-with-toggle",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search bookmarks...",value:k,onChange:function(e){b(e.target.value),y(function(a){return(0,l._)((0,i._)({},a),{searchTerm:e.target.value,fileFilter:h||""})})},className:"overlay-search-input"}),(0,r.jsx)("button",{onClick:function(){return w(!0)},className:"advanced-toggle-btn",title:"Enable advanced search",children:"\uD83D\uDD0D+"})]})}),(0,r.jsx)("ul",{className:"bookmark-list",children:C.map(function(e){return(0,r.jsxs)("li",{className:"bookmark-item",onClick:function(){return A(e.id)},title:`Click to jump to ${e.title}`,"data-clickable":"true",children:[(0,r.jsx)("span",{className:"bookmark-title",children:(0,r.jsx)(d.default,{text:e.title,searchTerms:k,caseSensitive:!1})}),e.tags&&e.tags.length>0&&(0,r.jsx)("div",{className:"bookmark-tags",children:e.tags.map(function(e){return(0,r.jsx)("span",{className:"bookmark-tag",children:e},e)})}),(0,r.jsx)("span",{className:"bookmark-time",children:new Date(1e3*(e.timestamp||0)).toISOString().substr(11,8)})]},e.id)})})]}):null},{}))}();
//# sourceMappingURL=overlay.1d1025e6.js.map
