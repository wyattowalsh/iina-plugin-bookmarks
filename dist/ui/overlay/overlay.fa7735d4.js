import"../window/window.d761c722.js";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},t={},l=e.parcelRequire9a9a;null==l&&((l=function(e){if(e in a)return a[e].exports;if(e in t){var l=t[e];delete t[e];var s={id:e,exports:{}};return a[e]=s,l.call(s.exports,s,s.exports),s.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,a){t[e]=a},e.parcelRequire9a9a=l),l.register;var s=l("YgFEM");l("18qrn");var r=l("d677Q"),i=l("3ruKn"),n=l("6r7ZQ"),s=l("YgFEM"),o=l("18qrn"),d=l("jvi9v"),c=l("mKhnF"),u=l("8zbWC");let m=document.getElementById("app");m&&(0,r.createRoot)(m).render((0,s.jsx)(()=>{let[e,a]=(0,o.useState)([]),[t,l]=(0,o.useState)(!0),[r,m]=(0,o.useState)(void 0),[h,p]=(0,o.useState)(""),[v,g]=(0,o.useState)({searchTerm:"",dateRange:{start:"",end:""},tags:[],sortBy:"createdAt",sortDirection:"desc",fileFilter:""}),[f,k]=(0,o.useState)(),[b,x]=(0,o.useState)(!1),y=window,{filteredBookmarks:E,availableTags:j}=(0,u.default)({bookmarks:e,filters:v,parsedQuery:b?f:void 0});(0,o.useEffect)(()=>{var e,t;let l=e=>{let t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){return}(null==t?void 0:t.type)==="BOOKMARKS_UPDATED"&&t.data?a(r?t.data.filter(e=>e.filepath===r):t.data):(null==t?void 0:t.type)==="CURRENT_FILE_PATH"&&t.data&&(m(t.data),a(e=>t.data?e.filter(e=>e.filepath===t.data):e))};return(null==(e=y.iina)?void 0:e.onMessage)?y.iina.onMessage("message",l):window.addEventListener("message",l),(null==(t=y.iina)?void 0:t.postMessage)&&(y.iina.postMessage("UI_READY",{uiType:"overlay"}),y.iina.postMessage("REQUEST_FILE_PATH")),()=>{var e;(null==(e=y.iina)?void 0:e.onMessage)||window.removeEventListener("message",l)}},[r]);let w=e=>{var a,t;null==(t=y.iina)||null==(a=t.postMessage)||a.call(t,"JUMP_TO_BOOKMARK",{id:e})},S=r?E.filter(e=>e.filepath===r):[];return t&&0!==S.length?(0,s.jsxs)("div",{className:"bookmark-overlay",children:[(0,s.jsxs)("div",{className:"bookmark-overlay-header",children:[(0,s.jsxs)("h3",{children:["Bookmarks (",S.length,")"]}),(0,s.jsx)("button",{onClick:()=>{var e,a;null==(a=y.iina)||null==(e=a.postMessage)||e.call(a,"HIDE_OVERLAY"),l(!1)},className:"close-btn","data-clickable":"true",children:"Ã—"})]}),e.filter(e=>e.filepath===r).length>3&&(0,s.jsx)("div",{className:"overlay-search",children:b?(0,s.jsx)(d.default,{onSearchChange:(e,a)=>{k(a),g(a=>(0,n._)((0,i._)({},a),{searchTerm:e,fileFilter:r||""})),p(e)},availableTags:j,placeholder:"Search... (try: tag:work)",className:"overlay-compact"}):(0,s.jsxs)("div",{className:"search-with-toggle",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search bookmarks...",value:h,onChange:e=>{p(e.target.value),g(a=>(0,n._)((0,i._)({},a),{searchTerm:e.target.value,fileFilter:r||""}))},className:"overlay-search-input"}),(0,s.jsx)("button",{onClick:()=>x(!0),className:"advanced-toggle-btn",title:"Enable advanced search",children:"\uD83D\uDD0D+"})]})}),(0,s.jsx)("ul",{className:"bookmark-list",children:S.map(e=>(0,s.jsxs)("li",{className:"bookmark-item",onClick:()=>w(e.id),title:`Click to jump to ${e.title}`,"data-clickable":"true",children:[(0,s.jsx)("span",{className:"bookmark-title",children:(0,s.jsx)(c.default,{text:e.title,searchTerms:h,caseSensitive:!1})}),(0,s.jsx)("span",{className:"bookmark-time",children:new Date(1e3*(e.timestamp||0)).toISOString().substr(11,8)})]},e.id))})]}):null},{}));
//# sourceMappingURL=overlay.fa7735d4.js.map
