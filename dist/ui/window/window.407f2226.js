import"./window.5148fe9c.js";import"./window.6ccc4a8e.js";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},a={},t=e.parcelRequire9a9a;null==t&&((t=function(e){if(e in s)return s[e].exports;if(e in a){var t=a[e];delete a[e];var i={id:e,exports:{}};return s[e]=i,t.call(i.exports,i,i.exports),i.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,s){a[e]=s},e.parcelRequire9a9a=t),t.register;var i=t("YgFEM");t("18qrn");var l=t("d677Q"),n=t("3ruKn"),r=t("6r7ZQ"),i=t("YgFEM"),c=t("18qrn"),o=t("8YcBG"),d=t("jvi9v"),i=t("YgFEM"),c=t("18qrn");let h=[{id:"recent",name:"Recent",description:"Bookmarks created today",filters:{dateRange:{start:new Date().toISOString().split("T")[0],end:""},sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83D\uDD52"},{id:"this-week",name:"This Week",description:"Bookmarks from the past 7 days",filters:{dateRange:{start:new Date(Date.now()-6048e5).toISOString().split("T")[0],end:""},sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83D\uDCC5"},{id:"untagged",name:"Untagged",description:"Bookmarks without any tags",filters:{searchTerm:"",tags:[],sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83C\uDFF7️"},{id:"favorites",name:"Favorites",description:"Bookmarks with favorite tag",filters:{tags:["favorite"],sortBy:"createdAt",sortDirection:"desc"},icon:"⭐"},{id:"no-description",name:"Need Description",description:"Bookmarks missing descriptions",filters:{searchTerm:"",sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83D\uDCDD"}];var m=({onApplyPreset:e,onSaveCurrentAsPreset:s,currentFilters:a,customPresets:t=[],recentSearches:l=[],onClearHistory:n,className:r=""})=>{let[o,d]=(0,c.useState)(!1),[m,u]=(0,c.useState)(""),[p,g]=(0,c.useState)(""),[x,v]=(0,c.useState)("presets"),j=[...h,...t],k=(0,c.useCallback)(s=>{e(s.filters)},[e]),N=(0,c.useCallback)(()=>{m.trim()&&(s(m.trim(),p.trim()),u(""),g(""),d(!1))},[m,p,s]),f=(0,c.useCallback)(e=>{let s=e.filters;return(void 0===s.searchTerm||s.searchTerm===a.searchTerm)&&(!s.sortBy||s.sortBy===a.sortBy)&&(!s.sortDirection||s.sortDirection===a.sortDirection)&&(!s.tags||JSON.stringify(s.tags)===JSON.stringify(a.tags))&&(void 0===s.fileFilter||s.fileFilter===a.fileFilter)},[a]),b=(0,c.useCallback)(()=>""!==a.searchTerm||""!==a.dateRange.start||""!==a.dateRange.end||a.tags.length>0||""!==a.fileFilter||"createdAt"!==a.sortBy||"desc"!==a.sortDirection,[a]),C=(0,c.useCallback)(s=>{e({searchTerm:s})},[e]);return(0,i.jsxs)("div",{className:`filter-presets ${r}`,children:[(0,i.jsxs)("div",{className:"presets-section",children:[(0,i.jsxs)("div",{className:"section-header",onClick:()=>v("presets"===x?null:"presets"),children:[(0,i.jsx)("span",{className:"section-icon",children:"presets"===x?"▼":"▶"}),(0,i.jsx)("span",{className:"section-title",children:"Quick Filters"}),(0,i.jsxs)("span",{className:"section-count",children:["(",j.length,")"]})]}),"presets"===x&&(0,i.jsxs)("div",{className:"presets-content",children:[(0,i.jsx)("div",{className:"preset-grid",children:j.map(e=>(0,i.jsxs)("button",{className:`preset-button ${f(e)?"active":""}`,onClick:()=>k(e),title:e.description,children:[e.icon&&(0,i.jsx)("span",{className:"preset-icon",children:e.icon}),(0,i.jsx)("span",{className:"preset-name",children:e.name})]},e.id))}),b()&&(0,i.jsx)("div",{className:"save-preset-section",children:o?(0,i.jsxs)("div",{className:"save-preset-dialog",children:[(0,i.jsx)("input",{type:"text",placeholder:"Preset name",value:m,onChange:e=>u(e.target.value),className:"preset-name-input"}),(0,i.jsx)("input",{type:"text",placeholder:"Description (optional)",value:p,onChange:e=>g(e.target.value),className:"preset-description-input"}),(0,i.jsxs)("div",{className:"dialog-actions",children:[(0,i.jsx)("button",{onClick:N,className:"save-btn",disabled:!m.trim(),children:"Save"}),(0,i.jsx)("button",{onClick:()=>d(!1),className:"cancel-btn",children:"Cancel"})]})]}):(0,i.jsx)("button",{className:"save-preset-trigger",onClick:()=>d(!0),children:"\uD83D\uDCBE Save Current Filters as Preset"})})]})]}),l.length>0&&(0,i.jsxs)("div",{className:"history-section",children:[(0,i.jsxs)("div",{className:"section-header",onClick:()=>v("history"===x?null:"history"),children:[(0,i.jsx)("span",{className:"section-icon",children:"history"===x?"▼":"▶"}),(0,i.jsx)("span",{className:"section-title",children:"Recent Searches"}),(0,i.jsxs)("span",{className:"section-count",children:["(",l.length,")"]})]}),"history"===x&&(0,i.jsxs)("div",{className:"history-content",children:[(0,i.jsx)("div",{className:"history-list",children:l.slice(0,5).map((e,s)=>(0,i.jsxs)("button",{className:"history-item",onClick:()=>C(e),title:`Apply search: ${e}`,children:[(0,i.jsx)("span",{className:"history-icon",children:"\uD83D\uDD0D"}),(0,i.jsx)("span",{className:"history-text",children:e})]},s))}),n&&(0,i.jsx)("button",{className:"clear-history-btn",onClick:n,children:"\uD83D\uDDD1️ Clear History"})]})]})]})},u=t("mKhnF"),i=t("YgFEM"),c=t("18qrn"),p=({tags:e,onTagsChange:s,placeholder:a="Add tags...",availableTags:t=[],maxTags:l=10,disabled:n=!1,className:r=""})=>{let[o,d]=(0,c.useState)(""),[h,m]=(0,c.useState)(!1),u=(0,c.useRef)(null),p=t.filter(s=>!e.includes(s)&&s.toLowerCase().includes(o.toLowerCase())),g=(0,c.useCallback)(a=>{let t=a.trim();t&&!e.includes(t)&&e.length<l&&(s([...e,t]),d(""),m(!1))},[e,s,l]),x=(0,c.useCallback)(a=>{s(e.filter(e=>e!==a))},[e,s]),v=(0,c.useCallback)(e=>{let s=e.target.value;d(s),m(s.length>0&&p.length>0)},[p.length]),j=(0,c.useCallback)(s=>{"Enter"===s.key||","===s.key?(s.preventDefault(),o.trim()&&g(o)):"Backspace"===s.key&&!o&&e.length>0?x(e[e.length-1]):"Escape"===s.key&&(m(!1),d(""))},[o,g,x,e]),k=(0,c.useCallback)(e=>{var s;g(e),null==(s=u.current)||s.focus()},[g]),N=(0,c.useCallback)(()=>{o&&p.length>0&&m(!0)},[o,p.length]),f=(0,c.useCallback)(()=>{setTimeout(()=>m(!1),150)},[]);return(0,i.jsxs)("div",{className:`tag-input-container ${r}`,children:[(0,i.jsxs)("div",{className:"tag-input-field",children:[e.map(e=>(0,i.jsxs)("span",{className:"tag-chip",children:[(0,i.jsx)("span",{className:"tag-text",children:e}),!n&&(0,i.jsx)("button",{type:"button",className:"tag-remove",onClick:()=>x(e),"aria-label":`Remove tag ${e}`,children:"×"})]},e)),!n&&e.length<l&&(0,i.jsx)("input",{ref:u,type:"text",value:o,onChange:v,onKeyDown:j,onFocus:N,onBlur:f,placeholder:0===e.length?a:"",className:"tag-input"})]}),h&&p.length>0&&(0,i.jsx)("div",{className:"tag-suggestions",children:p.slice(0,5).map(e=>(0,i.jsx)("button",{type:"button",className:"tag-suggestion",onClick:()=>k(e),children:e},e))}),e.length>=l&&(0,i.jsxs)("div",{className:"tag-limit-message",children:["Maximum ",l," tags allowed"]})]})},g=t("8zbWC"),x=t("cEMf7");let v=document.getElementById("app");v&&(0,l.createRoot)(v).render((0,i.jsx)(()=>{let[e,s]=(0,c.useState)([]),[a,t]=(0,c.useState)(null),[l,h]=(0,c.useState)(!1),[v,j]=(0,c.useState)(""),[k,N]=(0,c.useState)(""),[f,b]=(0,c.useState)([]),[C,D]=(0,c.useState)(void 0),[y,S]=(0,c.useState)({searchTerm:"",dateRange:{start:"",end:""},tags:[],sortBy:"createdAt",sortDirection:"desc",fileFilter:""}),[T,w]=(0,c.useState)(),[A,F]=(0,c.useState)(!1),B=window,{filteredBookmarks:E,resultsCount:R,availableFiles:M,availableTags:_,analytics:O}=(0,g.default)({bookmarks:e,filters:y,parsedQuery:A?T:void 0}),{recentSearches:P,customPresets:K,addRecentSearch:L,clearRecentSearches:U,saveFilterPreset:H,deleteFilterPreset:$,incrementPresetUsage:I}=(0,x.default)();(0,c.useEffect)(()=>{var e,i;let l=e=>{let i=e.data;if("string"==typeof e.data)try{i=JSON.parse(e.data)}catch(e){return}(null==i?void 0:i.type)==="BOOKMARKS_UPDATED"&&i.data?(s(i.data),a&&!i.data.find(e=>e.id===a.id)&&(t(null),h(!1))):(null==i?void 0:i.type)==="CURRENT_FILE_PATH"&&i.data&&D(i.data)};return(null==(e=B.iina)?void 0:e.onMessage)?B.iina.onMessage("message",l):window.addEventListener("message",l),(null==(i=B.iina)?void 0:i.postMessage)&&(B.iina.postMessage("UI_READY",{uiType:"window"}),B.iina.postMessage("REQUEST_FILE_PATH")),()=>{var e;(null==(e=B.iina)?void 0:e.onMessage)||window.removeEventListener("message",l)}},[a]);let q=e=>{var s,a;null==(a=B.iina)||null==(s=a.postMessage)||s.call(a,"DELETE_BOOKMARK",{id:e})},Y=e=>{var s,a;null==(a=B.iina)||null==(s=a.postMessage)||s.call(a,"JUMP_TO_BOOKMARK",{id:e})},J=e=>{t(e),j(e.title),N(e.description||""),b(e.tags||[]),h(!0)},Q=e=>new Date(1e3*e).toISOString().substr(11,8);return(0,i.jsxs)("div",{className:"bookmark-window",children:[(0,i.jsxs)("div",{className:"window-header",children:[(0,i.jsx)("h1",{children:"Manage All Bookmarks"}),(0,i.jsx)("div",{className:"header-actions",children:(0,i.jsx)("button",{onClick:()=>{var e,s;null==(s=B.iina)||null==(e=s.postMessage)||e.call(s,"ADD_BOOKMARK",{title:`New Bookmark ${new Date().toLocaleTimeString()}`,timestamp:null,description:"Added from bookmark manager window"})},className:"add-bookmark-btn",children:"Add Bookmark to Current Video"})})]}),(0,i.jsx)(m,{onApplyPreset:e=>{S(s=>(0,n._)({},s,e))},onSaveCurrentAsPreset:(e,s)=>{H(e,s,y)},currentFilters:y,customPresets:K,recentSearches:P,onClearHistory:U}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"advanced-search-toggle",onClick:()=>F(!A),children:[(0,i.jsx)("span",{className:`toggle-icon ${A?"expanded":""}`,children:"▶"}),(0,i.jsx)("span",{children:"Advanced Search"})]}),O.hasActiveFilters&&(0,i.jsxs)("div",{className:"filter-analytics",children:[(0,i.jsxs)("div",{className:"analytics-item",children:[(0,i.jsx)("span",{className:"analytics-icon",children:"\uD83D\uDCCA"}),(0,i.jsx)("span",{className:"analytics-value",children:O.filteredCount}),(0,i.jsxs)("span",{children:["of ",O.totalBookmarks]})]}),O.reductionPercentage>0&&(0,i.jsxs)("div",{className:`analytics-item reduction-percentage ${O.reductionPercentage>75?"high-reduction":""}`,children:[(0,i.jsx)("span",{className:"analytics-icon",children:"\uD83D\uDCC9"}),(0,i.jsxs)("span",{className:"analytics-value",children:[O.reductionPercentage,"%"]}),(0,i.jsx)("span",{children:"filtered out"})]})]})]}),A?(0,i.jsx)(d.default,{onSearchChange:(e,s)=>{w(s),S(s=>(0,r._)((0,n._)({},s),{searchTerm:e})),e.trim()&&L(e)},availableTags:_,availableFiles:M,recentSearches:P}):(0,i.jsx)(o.default,{onFilterChange:S,availableTags:_,availableFiles:M,resultsCount:R,showAdvanced:!0,initialFilters:y}),(0,i.jsxs)("div",{className:"content-area",children:[(0,i.jsx)("div",{className:"bookmark-list-panel",children:0===E.length?(0,i.jsx)("p",{className:"empty-state-text",children:"No bookmarks match your current filters."}):E.map(e=>(0,i.jsxs)("div",{className:`bookmark-entry ${(null==a?void 0:a.id)===e.id?"selected":""}`,onClick:()=>t(e),children:[(0,i.jsx)("h4",{children:(0,i.jsx)(u.default,{text:e.title,searchTerms:y.searchTerm,caseSensitive:!1})}),(0,i.jsxs)("p",{className:"filepath",title:e.filepath,children:[e.filepath.split("/").pop()," (",Q(e.timestamp),")"]}),e.tags&&e.tags.length>0&&(0,i.jsx)("div",{className:"bookmark-tags-small",children:e.tags.map(e=>(0,i.jsx)("span",{className:"bookmark-tag-small",children:e},e))}),(0,i.jsxs)("p",{className:"created-date-small",children:["Added: ",new Date(e.createdAt).toLocaleDateString()]})]},e.id))}),a&&(0,i.jsx)("div",{className:"bookmark-detail-panel",children:l?(0,i.jsxs)("div",{className:"edit-form",children:[(0,i.jsx)("h3",{children:"Edit Bookmark"}),(0,i.jsx)("input",{type:"text",value:v,onChange:e=>j(e.target.value),placeholder:"Title"}),(0,i.jsx)("textarea",{value:k,onChange:e=>N(e.target.value),placeholder:"Description"}),(0,i.jsx)(p,{tags:f,onTagsChange:b,availableTags:_}),(0,i.jsxs)("div",{className:"edit-actions",children:[(0,i.jsx)("button",{onClick:()=>{if(a){var e,i;null==(i=B.iina)||null==(e=i.postMessage)||e.call(i,"UPDATE_BOOKMARK",{id:a.id,data:{title:v,description:k,tags:f}}),h(!1),t(e=>e?(0,r._)((0,n._)({},e),{title:v,description:k,tags:f}):null),s(e=>e.map(e=>e.id===a.id?(0,r._)((0,n._)({},e),{title:v,description:k,tags:f}):e))}},className:"save-btn",children:"Save Changes"}),(0,i.jsx)("button",{onClick:()=>h(!1),className:"cancel-btn",children:"Cancel"})]})]}):(0,i.jsxs)("div",{className:"details-view",children:[(0,i.jsx)("h3",{children:(0,i.jsx)(u.default,{text:a.title,searchTerms:y.searchTerm,caseSensitive:!1})}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"File:"})," ",(0,i.jsx)("span",{title:a.filepath,children:a.filepath})]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Time:"})," ",Q(a.timestamp)]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Description:"}),(0,i.jsx)(u.default,{text:a.description||"N/A",searchTerms:y.searchTerm,caseSensitive:!1})]}),a.tags&&a.tags.length>0&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Tags:"})," ",a.tags.join(", ")]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Created:"})," ",new Date(a.createdAt).toLocaleString()]}),(0,i.jsxs)("div",{className:"detail-actions",children:[(0,i.jsx)("button",{onClick:()=>Y(a.id),className:"jump-btn",children:"Jump To"}),(0,i.jsx)("button",{onClick:()=>J(a),className:"edit-btn",children:"Edit"}),(0,i.jsx)("button",{onClick:()=>q(a.id),className:"delete-btn-detail",children:"Delete"})]})]})}),!a&&E.length>0&&(0,i.jsx)("div",{className:"bookmark-detail-panel placeholder-panel",children:(0,i.jsx)("p",{children:"Select a bookmark from the list to view or edit its details."})})]})]})},{}));
//# sourceMappingURL=window.407f2226.js.map
