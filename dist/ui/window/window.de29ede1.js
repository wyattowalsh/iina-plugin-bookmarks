import"./window.5148fe9c.js";import"./window.6ccc4a8e.js";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},a={},t=e.parcelRequire9a9a;null==t&&((t=function(e){if(e in s)return s[e].exports;if(e in a){var t=a[e];delete a[e];var i={id:e,exports:{}};return s[e]=i,t.call(i.exports,i,i.exports),i.exports}var l=Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,s){a[e]=s},e.parcelRequire9a9a=t),t.register;var i=t("YgFEM");t("18qrn");var l=t("d677Q"),n=t("3ruKn"),r=t("6r7ZQ"),i=t("YgFEM"),c=t("18qrn"),o=t("8YcBG"),d=t("jvi9v"),i=t("YgFEM"),c=t("18qrn");let h=[{id:"recent",name:"Recent",description:"Bookmarks created today",filters:{dateRange:{start:new Date().toISOString().split("T")[0],end:""},sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83D\uDD52"},{id:"this-week",name:"This Week",description:"Bookmarks from the past 7 days",filters:{dateRange:{start:new Date(Date.now()-6048e5).toISOString().split("T")[0],end:""},sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83D\uDCC5"},{id:"untagged",name:"Untagged",description:"Bookmarks without any tags",filters:{searchTerm:"",tags:[],sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83C\uDFF7️"},{id:"favorites",name:"Favorites",description:"Bookmarks with favorite tag",filters:{tags:["favorite"],sortBy:"createdAt",sortDirection:"desc"},icon:"⭐"},{id:"no-description",name:"Need Description",description:"Bookmarks missing descriptions",filters:{searchTerm:"",sortBy:"createdAt",sortDirection:"desc"},icon:"\uD83D\uDCDD"}];var m=({onApplyPreset:e,onSaveCurrentAsPreset:s,currentFilters:a,customPresets:t=[],recentSearches:l=[],onClearHistory:n,className:r=""})=>{let[o,d]=(0,c.useState)(!1),[m,u]=(0,c.useState)(""),[p,g]=(0,c.useState)(""),[x,v]=(0,c.useState)("presets"),j=[...h,...t],k=(0,c.useCallback)(s=>{e(s.filters)},[e]),N=(0,c.useCallback)(()=>{m.trim()&&(s(m.trim(),p.trim()),u(""),g(""),d(!1))},[m,p,s]),f=(0,c.useCallback)(e=>{let s=e.filters;return(void 0===s.searchTerm||s.searchTerm===a.searchTerm)&&(!s.sortBy||s.sortBy===a.sortBy)&&(!s.sortDirection||s.sortDirection===a.sortDirection)&&(!s.tags||JSON.stringify(s.tags)===JSON.stringify(a.tags))&&(void 0===s.fileFilter||s.fileFilter===a.fileFilter)},[a]),b=(0,c.useCallback)(()=>""!==a.searchTerm||""!==a.dateRange.start||""!==a.dateRange.end||a.tags.length>0||""!==a.fileFilter||"createdAt"!==a.sortBy||"desc"!==a.sortDirection,[a]),y=(0,c.useCallback)(s=>{e({searchTerm:s})},[e]);return(0,i.jsxs)("div",{className:`filter-presets ${r}`,children:[(0,i.jsxs)("div",{className:"presets-section",children:[(0,i.jsxs)("div",{className:"section-header",onClick:()=>v("presets"===x?null:"presets"),children:[(0,i.jsx)("span",{className:"section-icon",children:"presets"===x?"▼":"▶"}),(0,i.jsx)("span",{className:"section-title",children:"Quick Filters"}),(0,i.jsxs)("span",{className:"section-count",children:["(",j.length,")"]})]}),"presets"===x&&(0,i.jsxs)("div",{className:"presets-content",children:[(0,i.jsx)("div",{className:"preset-grid",children:j.map(e=>(0,i.jsxs)("button",{className:`preset-button ${f(e)?"active":""}`,onClick:()=>k(e),title:e.description,children:[e.icon&&(0,i.jsx)("span",{className:"preset-icon",children:e.icon}),(0,i.jsx)("span",{className:"preset-name",children:e.name})]},e.id))}),b()&&(0,i.jsx)("div",{className:"save-preset-section",children:o?(0,i.jsxs)("div",{className:"save-preset-dialog",children:[(0,i.jsx)("input",{type:"text",placeholder:"Preset name",value:m,onChange:e=>u(e.target.value),className:"preset-name-input"}),(0,i.jsx)("input",{type:"text",placeholder:"Description (optional)",value:p,onChange:e=>g(e.target.value),className:"preset-description-input"}),(0,i.jsxs)("div",{className:"dialog-actions",children:[(0,i.jsx)("button",{onClick:N,className:"save-btn",disabled:!m.trim(),children:"Save"}),(0,i.jsx)("button",{onClick:()=>d(!1),className:"cancel-btn",children:"Cancel"})]})]}):(0,i.jsx)("button",{className:"save-preset-trigger",onClick:()=>d(!0),children:"\uD83D\uDCBE Save Current Filters as Preset"})})]})]}),l.length>0&&(0,i.jsxs)("div",{className:"history-section",children:[(0,i.jsxs)("div",{className:"section-header",onClick:()=>v("history"===x?null:"history"),children:[(0,i.jsx)("span",{className:"section-icon",children:"history"===x?"▼":"▶"}),(0,i.jsx)("span",{className:"section-title",children:"Recent Searches"}),(0,i.jsxs)("span",{className:"section-count",children:["(",l.length,")"]})]}),"history"===x&&(0,i.jsxs)("div",{className:"history-content",children:[(0,i.jsx)("div",{className:"history-list",children:l.slice(0,5).map((e,s)=>(0,i.jsxs)("button",{className:"history-item",onClick:()=>y(e),title:`Apply search: ${e}`,children:[(0,i.jsx)("span",{className:"history-icon",children:"\uD83D\uDD0D"}),(0,i.jsx)("span",{className:"history-text",children:e})]},s))}),n&&(0,i.jsx)("button",{className:"clear-history-btn",onClick:n,children:"\uD83D\uDDD1️ Clear History"})]})]})]})},u=t("mKhnF"),i=t("YgFEM"),c=t("18qrn"),p=({tags:e,onTagsChange:s,placeholder:a="Add tags...",availableTags:t=[],maxTags:l=10,disabled:n=!1,className:r=""})=>{let[o,d]=(0,c.useState)(""),[h,m]=(0,c.useState)(!1),u=(0,c.useRef)(null),p=t.filter(s=>!e.includes(s)&&s.toLowerCase().includes(o.toLowerCase())),g=(0,c.useCallback)(a=>{let t=a.trim();t&&!e.includes(t)&&e.length<l&&(s([...e,t]),d(""),m(!1))},[e,s,l]),x=(0,c.useCallback)(a=>{s(e.filter(e=>e!==a))},[e,s]),v=(0,c.useCallback)(e=>{let s=e.target.value;d(s),m(s.length>0&&p.length>0)},[p.length]),j=(0,c.useCallback)(s=>{"Enter"===s.key||","===s.key?(s.preventDefault(),o.trim()&&g(o)):"Backspace"===s.key&&!o&&e.length>0?x(e[e.length-1]):"Escape"===s.key&&(m(!1),d(""))},[o,g,x,e]),k=(0,c.useCallback)(e=>{var s;g(e),null==(s=u.current)||s.focus()},[g]),N=(0,c.useCallback)(()=>{o&&p.length>0&&m(!0)},[o,p.length]),f=(0,c.useCallback)(()=>{setTimeout(()=>m(!1),150)},[]);return(0,i.jsxs)("div",{className:`tag-input-container ${r}`,children:[(0,i.jsxs)("div",{className:"tag-input-field",children:[e.map(e=>(0,i.jsxs)("span",{className:"tag-chip",children:[(0,i.jsx)("span",{className:"tag-text",children:e}),!n&&(0,i.jsx)("button",{type:"button",className:"tag-remove",onClick:()=>x(e),"aria-label":`Remove tag ${e}`,children:"×"})]},e)),!n&&e.length<l&&(0,i.jsx)("input",{ref:u,type:"text",value:o,onChange:v,onKeyDown:j,onFocus:N,onBlur:f,placeholder:0===e.length?a:"",className:"tag-input"})]}),h&&p.length>0&&(0,i.jsx)("div",{className:"tag-suggestions",children:p.slice(0,5).map(e=>(0,i.jsx)("button",{type:"button",className:"tag-suggestion",onClick:()=>k(e),children:e},e))}),e.length>=l&&(0,i.jsxs)("div",{className:"tag-limit-message",children:["Maximum ",l," tags allowed"]})]})},i=t("YgFEM"),c=t("18qrn"),g=({isOpen:e,onClose:s,onSave:a,availableTags:t,postMessage:l})=>{let[n,r]=(0,c.useState)(""),[o,d]=(0,c.useState)(""),[h,m]=(0,c.useState)([]),[u,g]=(0,c.useState)(0),[x,v]=(0,c.useState)(!1),[j,k]=(0,c.useState)(!1);(0,c.useEffect)(()=>{e&&l&&(k(!0),l("REQUEST_BOOKMARK_DEFAULTS"))},[e,l]),(0,c.useEffect)(()=>{let s=e=>{let s=e.data;if("string"==typeof e.data)try{s=JSON.parse(e.data)}catch(e){return}if((null==s?void 0:s.type)==="BOOKMARK_DEFAULTS"&&s.data){let e=s.data;r(e.title||""),d(e.description||""),m(e.tags||[]),g(e.timestamp||0),k(!1)}};if(e)return window.addEventListener("message",s),()=>window.removeEventListener("message",s)},[e]);let N=async()=>{if(n.trim()){v(!0);try{a(n.trim(),o.trim(),h,u),s(),r(""),d(""),m([]),g(0)}catch(e){console.error("Error saving bookmark:",e)}finally{v(!1)}}},f=()=>{s(),r(""),d(""),m([]),g(0),k(!1)};return e?(0,i.jsx)("div",{className:"dialog-overlay",children:(0,i.jsxs)("div",{className:"dialog-content add-bookmark-dialog",children:[(0,i.jsxs)("div",{className:"dialog-header",children:[(0,i.jsx)("h3",{children:"Add New Bookmark"}),(0,i.jsx)("button",{onClick:f,className:"close-btn",disabled:x,children:"×"})]}),(0,i.jsx)("div",{className:"dialog-body",children:j?(0,i.jsxs)("div",{className:"loading-defaults",children:[(0,i.jsx)("span",{className:"loading-spinner",children:"⏳"}),(0,i.jsx)("span",{children:"Loading metadata..."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"bookmark-title",children:"Title"}),(0,i.jsx)("input",{id:"bookmark-title",type:"text",value:n,onChange:e=>r(e.target.value),placeholder:"Bookmark title",disabled:x,autoFocus:!0})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"bookmark-timestamp",children:"Time"}),(0,i.jsxs)("div",{className:"timestamp-field",children:[(0,i.jsx)("input",{id:"bookmark-timestamp",type:"text",value:(e=>{let s=Math.floor(e/3600),a=Math.floor(e%3600/60),t=Math.floor(e%60);return s>0?`${s}:${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`:`${a}:${t.toString().padStart(2,"0")}`})(u),readOnly:!0,disabled:x}),(0,i.jsxs)("span",{className:"timestamp-note",children:[u,"s"]})]})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"bookmark-description",children:"Description"}),(0,i.jsx)("textarea",{id:"bookmark-description",value:o,onChange:e=>d(e.target.value),placeholder:"Optional description",rows:3,disabled:x})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{children:"Tags"}),(0,i.jsx)(p,{tags:h,onTagsChange:m,availableTags:t,disabled:x})]})]})}),(0,i.jsxs)("div",{className:"dialog-actions",children:[(0,i.jsx)("button",{onClick:N,className:"save-btn",disabled:!n.trim()||x||j,children:x?"Saving...":"Save Bookmark"}),(0,i.jsx)("button",{onClick:f,className:"cancel-btn",disabled:x,children:"Cancel"})]})]})}):null},x=t("8zbWC"),v=t("cEMf7");let j=document.getElementById("app");j&&(0,l.createRoot)(j).render((0,i.jsx)(()=>{var e;let[s,a]=(0,c.useState)([]),[t,l]=(0,c.useState)(null),[h,j]=(0,c.useState)(!1),[k,N]=(0,c.useState)(""),[f,b]=(0,c.useState)(""),[y,C]=(0,c.useState)([]),[S,D]=(0,c.useState)(void 0),[T,w]=(0,c.useState)({searchTerm:"",dateRange:{start:"",end:""},tags:[],sortBy:"createdAt",sortDirection:"desc",fileFilter:""}),[A,F]=(0,c.useState)(),[E,B]=(0,c.useState)(!1),[M,O]=(0,c.useState)(!1),R=window,{filteredBookmarks:_,resultsCount:P,availableFiles:K,availableTags:L,analytics:U}=(0,x.default)({bookmarks:s,filters:T,parsedQuery:E?A:void 0}),{recentSearches:$,customPresets:H,addRecentSearch:q,clearRecentSearches:I,saveFilterPreset:Y,deleteFilterPreset:J,incrementPresetUsage:Q}=(0,v.default)();(0,c.useEffect)(()=>{var e,s;let i=e=>{let s=e.data;if("string"==typeof e.data)try{s=JSON.parse(e.data)}catch(e){return}(null==s?void 0:s.type)==="BOOKMARKS_UPDATED"&&s.data?(a(s.data),t&&!s.data.find(e=>e.id===t.id)&&(l(null),j(!1))):(null==s?void 0:s.type)==="CURRENT_FILE_PATH"&&s.data&&D(s.data)};return(null==(e=R.iina)?void 0:e.onMessage)?R.iina.onMessage("message",i):window.addEventListener("message",i),(null==(s=R.iina)?void 0:s.postMessage)&&(R.iina.postMessage("UI_READY",{uiType:"window"}),R.iina.postMessage("REQUEST_FILE_PATH")),()=>{var e;(null==(e=R.iina)?void 0:e.onMessage)||window.removeEventListener("message",i)}},[t]);let W=e=>{var s,a;null==(a=R.iina)||null==(s=a.postMessage)||s.call(a,"DELETE_BOOKMARK",{id:e})},z=e=>{var s,a;null==(a=R.iina)||null==(s=a.postMessage)||s.call(a,"JUMP_TO_BOOKMARK",{id:e})},G=e=>{l(e),N(e.title),b(e.description||""),C(e.tags||[]),j(!0)},V=e=>new Date(1e3*e).toISOString().substr(11,8);return(0,i.jsxs)("div",{className:"bookmark-window",children:[(0,i.jsxs)("div",{className:"window-header",children:[(0,i.jsx)("h1",{children:"Manage All Bookmarks"}),(0,i.jsx)("div",{className:"header-actions",children:(0,i.jsx)("button",{onClick:()=>{O(!0)},className:"add-bookmark-btn",children:"Add Bookmark to Current Video"})})]}),(0,i.jsx)(g,{isOpen:M,onClose:()=>O(!1),onSave:(e,s,a,t)=>{var i,l;null==(l=R.iina)||null==(i=l.postMessage)||i.call(l,"ADD_BOOKMARK",{title:e,description:s,tags:a,timestamp:t})},availableTags:L,postMessage:null==(e=R.iina)?void 0:e.postMessage}),(0,i.jsx)(m,{onApplyPreset:e=>{w(s=>(0,n._)({},s,e))},onSaveCurrentAsPreset:(e,s)=>{Y(e,s,T)},currentFilters:T,customPresets:H,recentSearches:$,onClearHistory:I}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"advanced-search-toggle",onClick:()=>B(!E),children:[(0,i.jsx)("span",{className:`toggle-icon ${E?"expanded":""}`,children:"▶"}),(0,i.jsx)("span",{children:"Advanced Search"})]}),U.hasActiveFilters&&(0,i.jsxs)("div",{className:"filter-analytics",children:[(0,i.jsxs)("div",{className:"analytics-item",children:[(0,i.jsx)("span",{className:"analytics-icon",children:"\uD83D\uDCCA"}),(0,i.jsx)("span",{className:"analytics-value",children:U.filteredCount}),(0,i.jsxs)("span",{children:["of ",U.totalBookmarks]})]}),U.reductionPercentage>0&&(0,i.jsxs)("div",{className:`analytics-item reduction-percentage ${U.reductionPercentage>75?"high-reduction":""}`,children:[(0,i.jsx)("span",{className:"analytics-icon",children:"\uD83D\uDCC9"}),(0,i.jsxs)("span",{className:"analytics-value",children:[U.reductionPercentage,"%"]}),(0,i.jsx)("span",{children:"filtered out"})]})]})]}),E?(0,i.jsx)(d.default,{onSearchChange:(e,s)=>{F(s),w(s=>(0,r._)((0,n._)({},s),{searchTerm:e})),e.trim()&&q(e)},availableTags:L,availableFiles:K,recentSearches:$}):(0,i.jsx)(o.default,{onFilterChange:w,availableTags:L,availableFiles:K,resultsCount:P,showAdvanced:!0,initialFilters:T}),(0,i.jsxs)("div",{className:"content-area",children:[(0,i.jsx)("div",{className:"bookmark-list-panel",children:0===_.length?(0,i.jsx)("p",{className:"empty-state-text",children:"No bookmarks match your current filters."}):_.map(e=>(0,i.jsxs)("div",{className:`bookmark-entry ${(null==t?void 0:t.id)===e.id?"selected":""}`,onClick:()=>l(e),children:[(0,i.jsx)("h4",{children:(0,i.jsx)(u.default,{text:e.title,searchTerms:T.searchTerm,caseSensitive:!1})}),(0,i.jsxs)("p",{className:"filepath",title:e.filepath,children:[e.filepath.split("/").pop()," (",V(e.timestamp),")"]}),e.tags&&e.tags.length>0&&(0,i.jsx)("div",{className:"bookmark-tags-small",children:e.tags.map(e=>(0,i.jsx)("span",{className:"bookmark-tag-small",children:e},e))}),(0,i.jsxs)("p",{className:"created-date-small",children:["Added: ",new Date(e.createdAt).toLocaleDateString()]})]},e.id))}),t&&(0,i.jsx)("div",{className:"bookmark-detail-panel",children:h?(0,i.jsxs)("div",{className:"edit-form",children:[(0,i.jsx)("h3",{children:"Edit Bookmark"}),(0,i.jsx)("input",{type:"text",value:k,onChange:e=>N(e.target.value),placeholder:"Title"}),(0,i.jsx)("textarea",{value:f,onChange:e=>b(e.target.value),placeholder:"Description"}),(0,i.jsx)(p,{tags:y,onTagsChange:C,availableTags:L}),(0,i.jsxs)("div",{className:"edit-actions",children:[(0,i.jsx)("button",{onClick:()=>{if(t){var e,s;null==(s=R.iina)||null==(e=s.postMessage)||e.call(s,"UPDATE_BOOKMARK",{id:t.id,data:{title:k,description:f,tags:y}}),j(!1),l(e=>e?(0,r._)((0,n._)({},e),{title:k,description:f,tags:y}):null),a(e=>e.map(e=>e.id===t.id?(0,r._)((0,n._)({},e),{title:k,description:f,tags:y}):e))}},className:"save-btn",children:"Save Changes"}),(0,i.jsx)("button",{onClick:()=>j(!1),className:"cancel-btn",children:"Cancel"})]})]}):(0,i.jsxs)("div",{className:"details-view",children:[(0,i.jsx)("h3",{children:(0,i.jsx)(u.default,{text:t.title,searchTerms:T.searchTerm,caseSensitive:!1})}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"File:"})," ",(0,i.jsx)("span",{title:t.filepath,children:t.filepath})]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Time:"})," ",V(t.timestamp)]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Description:"}),(0,i.jsx)(u.default,{text:t.description||"N/A",searchTerms:T.searchTerm,caseSensitive:!1})]}),t.tags&&t.tags.length>0&&(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Tags:"})," ",t.tags.join(", ")]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"Created:"})," ",new Date(t.createdAt).toLocaleString()]}),(0,i.jsxs)("div",{className:"detail-actions",children:[(0,i.jsx)("button",{onClick:()=>z(t.id),className:"jump-btn",children:"Jump To"}),(0,i.jsx)("button",{onClick:()=>G(t),className:"edit-btn",children:"Edit"}),(0,i.jsx)("button",{onClick:()=>W(t.id),className:"delete-btn-detail",children:"Delete"})]})]})}),!t&&_.length>0&&(0,i.jsx)("div",{className:"bookmark-detail-panel placeholder-panel",children:(0,i.jsx)("p",{children:"Select a bookmark from the list to view or edit its details."})})]})]})},{}));
//# sourceMappingURL=window.de29ede1.js.map
