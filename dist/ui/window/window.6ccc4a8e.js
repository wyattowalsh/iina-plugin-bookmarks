function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,s){Object.defineProperty(e,t,{get:r,set:s,enumerable:!0,configurable:!0})}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},a={},i=r.parcelRequire9a9a;null==i&&((i=function(e){if(e in s)return s[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return s[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},r.parcelRequire9a9a=i);var l=i.register;l("8YcBG",function(r,s){t(r.exports,"default",()=>m);var a=i("3ruKn"),l=i("6r7ZQ"),n=i("YgFEM"),c=i("18qrn"),o=i("8muiM"),d=i("3sb15");let u={searchTerm:"",dateRange:{start:"",end:""},tags:[],sortBy:"createdAt",sortDirection:"desc",fileFilter:"",sortCriteria:[],enableMultiSort:!1};var m=({onFilterChange:t,availableTags:r=[],availableFiles:s=[],resultsCount:i,compact:m=!1,showAdvanced:g=!1,initialFilters:h={},viewId:p="default"})=>{let f=(0,a._)({},u,h),[v,x]=(0,d.usePersistentFilterState)(p,f),{saveSortPreferences:j}=(0,d.usePersistentSortPreferences)(p),[S,C]=(0,c.useState)(g),[b,N]=(0,c.useState)(!1),[k,y]=(0,c.useState)(v.searchTerm),P=(0,o.default)(k,300),w=(0,c.useCallback)(e=>{let r=(0,a._)({},v,e);x(r),t(r),("sortBy"in e||"sortDirection"in e||"sortCriteria"in e||"enableMultiSort"in e)&&j({sortBy:r.sortBy,sortDirection:r.sortDirection,sortCriteria:r.sortCriteria,enableMultiSort:r.enableMultiSort})},[v,t,x,j]);e(c).useEffect(()=>{P!==v.searchTerm&&w({searchTerm:P})},[P,v.searchTerm,w]),e(c).useEffect(()=>{t(v)},[]);let _=(0,c.useCallback)(e=>{y(e.target.value)},[]),F=(0,c.useCallback)(e=>{let[t,r]=e.target.value.split("-");w({sortBy:t,sortDirection:r})},[w]),T=(0,c.useCallback)((e,t)=>{w({dateRange:(0,l._)((0,a._)({},v.dateRange),{[e]:t})})},[v.dateRange,w]),D=(0,c.useCallback)(e=>{w({tags:v.tags.includes(e)?v.tags.filter(t=>t!==e):[...v.tags,e]})},[v.tags,w]),R=(0,c.useCallback)(e=>{w({tags:v.tags.filter(t=>t!==e)})},[v.tags,w]),A=(0,c.useCallback)(e=>{w({fileFilter:e.target.value})},[w]),U=(0,c.useCallback)(()=>{x(u),y(""),t(u)},[t]),E=(0,c.useMemo)(()=>v.searchTerm||v.dateRange.start||v.dateRange.end||v.tags.length>0||v.fileFilter,[v]),O=`${v.sortBy}-${v.sortDirection}`,M=(0,c.useCallback)((e,t,r)=>{let s=[...v.sortCriteria];("field"===t||"direction"===t)&&(s[e][t]=r),w({sortCriteria:s})},[v.sortCriteria,w]),B=(0,c.useCallback)(e=>{w({sortCriteria:v.sortCriteria.filter((t,r)=>r!==e)})},[v.sortCriteria,w]),$=(0,c.useCallback)(()=>{w({sortCriteria:[...v.sortCriteria,{field:v.sortBy,direction:v.sortDirection,priority:v.sortCriteria.length+1}]})},[v.sortBy,v.sortDirection,v.sortCriteria,w]);return(0,n.jsxs)("div",{className:`filter-container ${m?"compact":""}`,children:[(0,n.jsxs)("div",{className:"filter-row",children:[(0,n.jsx)("div",{className:"filter-group",children:(0,n.jsx)("input",{type:"text",className:`filter-input ${m?"compact":""}`,placeholder:"Search bookmarks...",value:k,onChange:_})}),(0,n.jsx)("div",{className:"filter-group",children:v.enableMultiSort?(0,n.jsxs)("div",{className:"multi-sort-container",children:[(0,n.jsxs)("div",{className:"multi-sort-header",children:[(0,n.jsx)("span",{children:"Multi-Sort"}),(0,n.jsx)("button",{onClick:()=>w({enableMultiSort:!1,sortCriteria:[]}),className:"disable-multi-sort",title:"Disable multi-criteria sorting",children:"✕"})]}),(0,n.jsxs)("div",{className:"multi-sort-criteria",children:[v.sortCriteria.map((e,t)=>(0,n.jsxs)("div",{className:"sort-criterion",children:[(0,n.jsx)("span",{className:"criterion-priority",children:t+1}),(0,n.jsxs)("select",{value:e.field,onChange:e=>M(t,"field",e.target.value),className:"criterion-field",children:[(0,n.jsx)("option",{value:"createdAt",children:"Date Created"}),(0,n.jsx)("option",{value:"title",children:"Title"}),(0,n.jsx)("option",{value:"timestamp",children:"Timestamp"}),(0,n.jsx)("option",{value:"description",children:"Description"}),(0,n.jsx)("option",{value:"tags",children:"Tags"}),(0,n.jsx)("option",{value:"mediaFileName",children:"File Name"})]}),(0,n.jsxs)("select",{value:e.direction,onChange:e=>M(t,"direction",e.target.value),className:"criterion-direction",children:[(0,n.jsx)("option",{value:"asc",children:"↑ Asc"}),(0,n.jsx)("option",{value:"desc",children:"↓ Desc"})]}),(0,n.jsx)("button",{onClick:()=>B(t),className:"remove-criterion",title:"Remove this sort criterion",children:"✕"})]},t)),v.sortCriteria.length<3&&(0,n.jsx)("button",{onClick:$,className:"add-criterion",title:"Add another sort criterion",children:"+ Add Sort"})]})]}):(0,n.jsxs)("div",{className:"single-sort-container",children:[(0,n.jsxs)("select",{className:`filter-select ${m?"compact":""}`,value:O,onChange:F,children:[(0,n.jsx)("option",{value:"createdAt-desc",children:"Latest First"}),(0,n.jsx)("option",{value:"createdAt-asc",children:"Oldest First"}),(0,n.jsx)("option",{value:"title-asc",children:"Title A-Z"}),(0,n.jsx)("option",{value:"title-desc",children:"Title Z-A"}),(0,n.jsx)("option",{value:"timestamp-asc",children:"Time (Start)"}),(0,n.jsx)("option",{value:"timestamp-desc",children:"Time (End)"}),(0,n.jsx)("option",{value:"description-asc",children:"Description A-Z"}),(0,n.jsx)("option",{value:"description-desc",children:"Description Z-A"}),(0,n.jsx)("option",{value:"tags-asc",children:"Tags A-Z"}),(0,n.jsx)("option",{value:"tags-desc",children:"Tags Z-A"}),(0,n.jsx)("option",{value:"mediaFileName-asc",children:"File Name A-Z"}),(0,n.jsx)("option",{value:"mediaFileName-desc",children:"File Name Z-A"})]}),(0,n.jsx)("button",{onClick:()=>w({enableMultiSort:!0,sortCriteria:[{field:v.sortBy,direction:v.sortDirection,priority:1}]}),className:"enable-multi-sort",title:"Enable multi-criteria sorting",children:"⚡ Multi"})]})}),s.length>0&&(0,n.jsx)("div",{className:"filter-group",children:(0,n.jsxs)("select",{className:`filter-select ${m?"compact":""}`,value:v.fileFilter,onChange:A,children:[(0,n.jsx)("option",{value:"",children:"All Files"}),s.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})}),r.length>0&&(0,n.jsx)("div",{className:"filter-group",children:(0,n.jsxs)("div",{className:"multi-select-dropdown",children:[(0,n.jsxs)("button",{className:`dropdown-toggle ${m?"compact":""}`,onClick:()=>N(!b),children:["Tags (",v.tags.length,")"]}),b&&(0,n.jsx)("div",{className:"dropdown-menu",children:r.map(e=>(0,n.jsxs)("div",{className:"dropdown-item",onClick:()=>D(e),children:[(0,n.jsx)("input",{type:"checkbox",checked:v.tags.includes(e),readOnly:!0}),(0,n.jsx)("span",{children:e})]},e))})]})})]}),v.tags.length>0&&(0,n.jsx)("div",{className:"filter-tags",children:v.tags.map(e=>(0,n.jsxs)("span",{className:"filter-tag",children:[e,(0,n.jsx)("span",{className:"remove-tag",onClick:()=>R(e),children:"×"})]},e))}),r.length>0&&(0,n.jsxs)("div",{className:"advanced-filter-panel",children:[(0,n.jsxs)("div",{className:"advanced-toggle",onClick:()=>C(!S),children:[(0,n.jsx)("span",{children:S?"▼":"▶"}),(0,n.jsx)("span",{children:"Advanced Filters"})]}),S&&(0,n.jsx)("div",{className:"advanced-content",children:(0,n.jsx)("div",{className:"filter-row",children:(0,n.jsxs)("div",{className:"filter-group",children:[(0,n.jsx)("label",{className:"filter-label",children:"Date Range"}),(0,n.jsxs)("div",{className:"date-range-picker",children:[(0,n.jsx)("input",{type:"date",value:v.dateRange.start,onChange:e=>T("start",e.target.value)}),(0,n.jsx)("span",{className:"date-separator",children:"to"}),(0,n.jsx)("input",{type:"date",value:v.dateRange.end,onChange:e=>T("end",e.target.value)})]})]})})})]}),(0,n.jsxs)("div",{className:"filter-row",children:[void 0!==i&&(0,n.jsxs)("div",{className:"filter-results-count",children:[i," bookmark",1!==i?"s":""," found"]}),E&&(0,n.jsx)("button",{className:"filter-clear",onClick:U,children:"Clear all filters"})]})]})}}),l("3sb15",function(e,r){t(e.exports,"usePersistentFilterState",()=>l),t(e.exports,"usePersistentSortPreferences",()=>n);var s=i("3ruKn"),a=i("18qrn");function l(e,t){var r=`iina-bookmarks-filters-${e}`;let[s,i]=(0,a.useState)(()=>{try{let e=window.localStorage.getItem(r);return e?JSON.parse(e):t}catch(e){return console.warn(`Error reading localStorage key "${r}":`,e),t}});return[s,e=>{try{i(e),window.localStorage.setItem(r,JSON.stringify(e))}catch(e){console.warn(`Error setting localStorage key "${r}":`,e)}}]}let n=e=>{let[t,r]=(0,a.useState)({});return{sortPreferences:t,saveSortPreferences:(0,a.useCallback)(t=>{var a;r(t);let i=window;(null==(a=i.iina)?void 0:a.postMessage)&&i.iina.postMessage("SAVE_SORT_PREFERENCES",{preferences:(0,s._)({viewId:e},t)})},[e])}}}),l("cEMf7",function(e,r){t(e.exports,"default",()=>c);var s=i("3ruKn"),a=i("6r7ZQ"),l=i("18qrn");let n="bookmark-filter-history";var c=()=>{let[e,t]=(0,l.useState)({recentSearches:[],customPresets:[],filterUsageStats:{}});(0,l.useEffect)(()=>{try{let e=localStorage.getItem(n);if(e){let r=JSON.parse(e);t({recentSearches:r.recentSearches||[],customPresets:r.customPresets||[],filterUsageStats:r.filterUsageStats||{}})}}catch(e){console.error("Error loading filter history:",e)}},[]);let r=(0,l.useCallback)(e=>{try{localStorage.setItem(n,JSON.stringify(e)),t(e)}catch(e){console.error("Error saving filter history:",e)}},[]),i=(0,l.useCallback)(t=>{if(!t.trim())return;let i=t.trim(),l=[i,...e.recentSearches.filter(e=>e!==i)].slice(0,10);r((0,a._)((0,s._)({},e),{recentSearches:l}))},[e,r]),c=(0,l.useCallback)(()=>{r((0,a._)((0,s._)({},e),{recentSearches:[]}))},[e,r]),o=(0,l.useCallback)((t,i,l)=>{let n={id:`custom-${Date.now()}`,name:t.trim(),description:i.trim(),filters:{searchTerm:l.searchTerm,dateRange:l.dateRange,tags:[...l.tags],sortBy:l.sortBy,sortDirection:l.sortDirection,fileFilter:l.fileFilter},createdAt:new Date().toISOString(),usageCount:0},c=[n,...e.customPresets.filter(e=>e.name!==t.trim())].slice(0,20);return r((0,a._)((0,s._)({},e),{customPresets:c})),n.id},[e,r]),d=(0,l.useCallback)(t=>{let i=e.customPresets.filter(e=>e.id!==t);r((0,a._)((0,s._)({},e),{customPresets:i}))},[e,r]),u=(0,l.useCallback)(t=>{let i=e.customPresets.map(e=>e.id===t?(0,a._)((0,s._)({},e),{usageCount:e.usageCount+1}):e);r((0,a._)((0,s._)({},e),{customPresets:i}))},[e,r]),m=(0,l.useCallback)(t=>{let i=(0,a._)((0,s._)({},e.filterUsageStats),{[t]:(e.filterUsageStats[t]||0)+1});r((0,a._)((0,s._)({},e),{filterUsageStats:i}))},[e,r]),g=(0,l.useCallback)(()=>Object.entries(e.filterUsageStats).sort(([,e],[,t])=>t-e).slice(0,5).map(([e,t])=>({filter:e,count:t})),[e.filterUsageStats]),h=(0,l.useCallback)(()=>[...e.customPresets].sort((e,t)=>t.usageCount-e.usageCount).slice(0,5),[e.customPresets]),p=(0,l.useCallback)(()=>{let t=new Blob([JSON.stringify((0,a._)((0,s._)({},e),{exportedAt:new Date().toISOString(),version:"1.0"}),null,2)],{type:"application/json"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`bookmark-filter-history-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)},[e]),f=(0,l.useCallback)(t=>new Promise(a=>{let i=new FileReader;i.onload=t=>{try{var i;let l=JSON.parse(null==(i=t.target)?void 0:i.result);if(l.recentSearches&&l.customPresets){let t={recentSearches:[...e.recentSearches,...l.recentSearches||[]].slice(0,10),customPresets:[...e.customPresets,...l.customPresets||[]].slice(0,20),filterUsageStats:(0,s._)({},e.filterUsageStats,l.filterUsageStats||{})};r(t),a(!0)}else a(!1)}catch(e){console.error("Error importing filter history:",e),a(!1)}},i.readAsText(t)}),[e,r]),v=(0,l.useCallback)(()=>{r({recentSearches:[],customPresets:[],filterUsageStats:{}})},[r]);return{recentSearches:e.recentSearches,customPresets:e.customPresets,filterUsageStats:e.filterUsageStats,addRecentSearch:i,clearRecentSearches:c,saveFilterPreset:o,deleteFilterPreset:d,incrementPresetUsage:u,trackFilterUsage:m,getMostUsedFilters:g,getPopularPresets:h,exportHistory:p,importHistory:f,clearAllHistory:v}}});
//# sourceMappingURL=window.6ccc4a8e.js.map
