!function(){function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,s){Object.defineProperty(e,t,{get:r,set:s,enumerable:!0,configurable:!0})}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},i={},a=r.parcelRequire9a9a;null==a&&((a=function(e){if(e in s)return s[e].exports;if(e in i){var t=i[e];delete i[e];var r={id:e,exports:{}};return s[e]=r,t.call(r.exports,r,r.exports),r.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},r.parcelRequire9a9a=a);var n=a.register;n("c04QX",function(r,s){t(r.exports,"default",function(){return h});var i=a("gDbdG"),n=a("78RNE"),o=a("hiL4o"),l=a("8IRNY"),c=a("jr3WH"),u=a("joq15"),d=a("h0YY3"),f=a("lIwkd"),m={searchTerm:"",dateRange:{start:"",end:""},tags:[],sortBy:"createdAt",sortDirection:"desc",fileFilter:"",sortCriteria:[],enableMultiSort:!1},h=function(t){var r=t.onFilterChange,s=t.availableTags,a=void 0===s?[]:s,h=t.availableFiles,g=void 0===h?[]:h,v=t.resultsCount,p=t.compact,x=void 0!==p&&p,j=t.showAdvanced,S=t.initialFilters,C=t.viewId,b=void 0===C?"default":C,N=(0,i._)({},m,void 0===S?{}:S),k=(0,o._)((0,f.usePersistentFilterState)(b,N),2),_=k[0],y=k[1],P=(0,f.usePersistentSortPreferences)(b).saveSortPreferences,w=(0,o._)((0,u.useState)(void 0!==j&&j),2),F=w[0],R=w[1],D=(0,o._)((0,u.useState)(!1),2),T=D[0],A=D[1],U=(0,o._)((0,u.useState)(_.searchTerm),2),E=U[0],O=U[1],M=(0,d.default)(E,300),I=(0,u.useCallback)(function(e){var t=(0,i._)({},_,e);y(t),r(t),("sortBy"in e||"sortDirection"in e||"sortCriteria"in e||"enableMultiSort"in e)&&P({sortBy:t.sortBy,sortDirection:t.sortDirection,sortCriteria:t.sortCriteria,enableMultiSort:t.enableMultiSort})},[_,r,y,P]);e(u).useEffect(function(){M!==_.searchTerm&&I({searchTerm:M})},[M,_.searchTerm,I]),e(u).useEffect(function(){r(_)},[]);var B=(0,u.useCallback)(function(e){O(e.target.value)},[]),$=(0,u.useCallback)(function(e){var t=(0,o._)(e.target.value.split("-"),2);I({sortBy:t[0],sortDirection:t[1]})},[I]),L=(0,u.useCallback)(function(e,t){I({dateRange:(0,n._)((0,i._)({},_.dateRange),{[e]:t})})},[_.dateRange,I]),Z=(0,u.useCallback)(function(e){I({tags:_.tags.includes(e)?_.tags.filter(function(t){return t!==e}):(0,l._)(_.tags).concat([e])})},[_.tags,I]),q=(0,u.useCallback)(function(e){I({tags:_.tags.filter(function(t){return t!==e})})},[_.tags,I]),J=(0,u.useCallback)(function(e){I({fileFilter:e.target.value})},[I]),H=(0,u.useCallback)(function(){y(m),O(""),r(m)},[r]),Y=(0,u.useMemo)(function(){return _.searchTerm||_.dateRange.start||_.dateRange.end||_.tags.length>0||_.fileFilter},[_]),G=`${_.sortBy}-${_.sortDirection}`,Q=(0,u.useCallback)(function(e,t,r){var s=(0,l._)(_.sortCriteria);("field"===t||"direction"===t)&&(s[e][t]=r),I({sortCriteria:s})},[_.sortCriteria,I]),V=(0,u.useCallback)(function(e){I({sortCriteria:_.sortCriteria.filter(function(t,r){return r!==e})})},[_.sortCriteria,I]),W=(0,u.useCallback)(function(){I({sortCriteria:(0,l._)(_.sortCriteria).concat([{field:_.sortBy,direction:_.sortDirection,priority:_.sortCriteria.length+1}])})},[_.sortBy,_.sortDirection,_.sortCriteria,I]);return(0,c.jsxs)("div",{className:`filter-container ${x?"compact":""}`,children:[(0,c.jsxs)("div",{className:"filter-row",children:[(0,c.jsx)("div",{className:"filter-group",children:(0,c.jsx)("input",{type:"text",className:`filter-input ${x?"compact":""}`,placeholder:"Search bookmarks...",value:E,onChange:B})}),(0,c.jsx)("div",{className:"filter-group",children:_.enableMultiSort?(0,c.jsxs)("div",{className:"multi-sort-container",children:[(0,c.jsxs)("div",{className:"multi-sort-header",children:[(0,c.jsx)("span",{children:"Multi-Sort"}),(0,c.jsx)("button",{onClick:function(){return I({enableMultiSort:!1,sortCriteria:[]})},className:"disable-multi-sort",title:"Disable multi-criteria sorting",children:"✕"})]}),(0,c.jsxs)("div",{className:"multi-sort-criteria",children:[_.sortCriteria.map(function(e,t){return(0,c.jsxs)("div",{className:"sort-criterion",children:[(0,c.jsx)("span",{className:"criterion-priority",children:t+1}),(0,c.jsxs)("select",{value:e.field,onChange:function(e){return Q(t,"field",e.target.value)},className:"criterion-field",children:[(0,c.jsx)("option",{value:"createdAt",children:"Date Created"}),(0,c.jsx)("option",{value:"title",children:"Title"}),(0,c.jsx)("option",{value:"timestamp",children:"Timestamp"}),(0,c.jsx)("option",{value:"description",children:"Description"}),(0,c.jsx)("option",{value:"tags",children:"Tags"}),(0,c.jsx)("option",{value:"mediaFileName",children:"File Name"})]}),(0,c.jsxs)("select",{value:e.direction,onChange:function(e){return Q(t,"direction",e.target.value)},className:"criterion-direction",children:[(0,c.jsx)("option",{value:"asc",children:"↑ Asc"}),(0,c.jsx)("option",{value:"desc",children:"↓ Desc"})]}),(0,c.jsx)("button",{onClick:function(){return V(t)},className:"remove-criterion",title:"Remove this sort criterion",children:"✕"})]},t)}),_.sortCriteria.length<3&&(0,c.jsx)("button",{onClick:W,className:"add-criterion",title:"Add another sort criterion",children:"+ Add Sort"})]})]}):(0,c.jsxs)("div",{className:"single-sort-container",children:[(0,c.jsxs)("select",{className:`filter-select ${x?"compact":""}`,value:G,onChange:$,children:[(0,c.jsx)("option",{value:"createdAt-desc",children:"Latest First"}),(0,c.jsx)("option",{value:"createdAt-asc",children:"Oldest First"}),(0,c.jsx)("option",{value:"title-asc",children:"Title A-Z"}),(0,c.jsx)("option",{value:"title-desc",children:"Title Z-A"}),(0,c.jsx)("option",{value:"timestamp-asc",children:"Time (Start)"}),(0,c.jsx)("option",{value:"timestamp-desc",children:"Time (End)"}),(0,c.jsx)("option",{value:"description-asc",children:"Description A-Z"}),(0,c.jsx)("option",{value:"description-desc",children:"Description Z-A"}),(0,c.jsx)("option",{value:"tags-asc",children:"Tags A-Z"}),(0,c.jsx)("option",{value:"tags-desc",children:"Tags Z-A"}),(0,c.jsx)("option",{value:"mediaFileName-asc",children:"File Name A-Z"}),(0,c.jsx)("option",{value:"mediaFileName-desc",children:"File Name Z-A"})]}),(0,c.jsx)("button",{onClick:function(){return I({enableMultiSort:!0,sortCriteria:[{field:_.sortBy,direction:_.sortDirection,priority:1}]})},className:"enable-multi-sort",title:"Enable multi-criteria sorting",children:"⚡ Multi"})]})}),g.length>0&&(0,c.jsx)("div",{className:"filter-group",children:(0,c.jsxs)("select",{className:`filter-select ${x?"compact":""}`,value:_.fileFilter,onChange:J,children:[(0,c.jsx)("option",{value:"",children:"All Files"}),g.map(function(e){return(0,c.jsx)("option",{value:e,children:e},e)})]})}),a.length>0&&(0,c.jsx)("div",{className:"filter-group",children:(0,c.jsxs)("div",{className:"multi-select-dropdown",children:[(0,c.jsxs)("button",{className:`dropdown-toggle ${x?"compact":""}`,onClick:function(){return A(!T)},children:["Tags (",_.tags.length,")"]}),T&&(0,c.jsx)("div",{className:"dropdown-menu",children:a.map(function(e){return(0,c.jsxs)("div",{className:"dropdown-item",onClick:function(){return Z(e)},children:[(0,c.jsx)("input",{type:"checkbox",checked:_.tags.includes(e),readOnly:!0}),(0,c.jsx)("span",{children:e})]},e)})})]})})]}),_.tags.length>0&&(0,c.jsx)("div",{className:"filter-tags",children:_.tags.map(function(e){return(0,c.jsxs)("span",{className:"filter-tag",children:[e,(0,c.jsx)("span",{className:"remove-tag",onClick:function(){return q(e)},children:"×"})]},e)})}),a.length>0&&(0,c.jsxs)("div",{className:"advanced-filter-panel",children:[(0,c.jsxs)("div",{className:"advanced-toggle",onClick:function(){return R(!F)},children:[(0,c.jsx)("span",{children:F?"▼":"▶"}),(0,c.jsx)("span",{children:"Advanced Filters"})]}),F&&(0,c.jsx)("div",{className:"advanced-content",children:(0,c.jsx)("div",{className:"filter-row",children:(0,c.jsxs)("div",{className:"filter-group",children:[(0,c.jsx)("label",{className:"filter-label",children:"Date Range"}),(0,c.jsxs)("div",{className:"date-range-picker",children:[(0,c.jsx)("input",{type:"date",value:_.dateRange.start,onChange:function(e){return L("start",e.target.value)}}),(0,c.jsx)("span",{className:"date-separator",children:"to"}),(0,c.jsx)("input",{type:"date",value:_.dateRange.end,onChange:function(e){return L("end",e.target.value)}})]})]})})})]}),(0,c.jsxs)("div",{className:"filter-row",children:[void 0!==v&&(0,c.jsxs)("div",{className:"filter-results-count",children:[v," bookmark",1!==v?"s":""," found"]}),Y&&(0,c.jsx)("button",{className:"filter-clear",onClick:H,children:"Clear all filters"})]})]})}}),n("lIwkd",function(e,r){t(e.exports,"usePersistentFilterState",function(){return o}),t(e.exports,"usePersistentSortPreferences",function(){return l});var s=a("gDbdG"),i=a("hiL4o"),n=a("joq15");function o(e,t){var r,s,a,o;return r=`iina-bookmarks-filters-${e}`,a=(s=(0,i._)((0,n.useState)(function(){try{var e=window.localStorage.getItem(r);return e?JSON.parse(e):t}catch(e){return console.warn(`Error reading localStorage key "${r}":`,e),t}}),2))[0],o=s[1],[a,function(e){try{o(e),window.localStorage.setItem(r,JSON.stringify(e))}catch(e){console.warn(`Error setting localStorage key "${r}":`,e)}}]}var l=function(e){var t=(0,i._)((0,n.useState)({}),2),r=t[0],a=t[1];return{sortPreferences:r,saveSortPreferences:(0,n.useCallback)(function(t){a(t);var r,i=window;(null==(r=i.iina)?void 0:r.postMessage)&&i.iina.postMessage("SAVE_SORT_PREFERENCES",{preferences:(0,s._)({viewId:e},t)})},[e])}}}),n("bfvSq",function(e,r){t(e.exports,"default",function(){return u});var s=a("gDbdG"),i=a("78RNE"),n=a("hiL4o"),o=a("8IRNY"),l=a("joq15"),c="bookmark-filter-history",u=function(){var e=(0,n._)((0,l.useState)({recentSearches:[],customPresets:[],filterUsageStats:{}}),2),t=e[0],r=e[1];(0,l.useEffect)(function(){try{var e=localStorage.getItem(c);if(e){var t=JSON.parse(e);r({recentSearches:t.recentSearches||[],customPresets:t.customPresets||[],filterUsageStats:t.filterUsageStats||{}})}}catch(e){console.error("Error loading filter history:",e)}},[]);var a=(0,l.useCallback)(function(e){try{localStorage.setItem(c,JSON.stringify(e)),r(e)}catch(e){console.error("Error saving filter history:",e)}},[]),u=(0,l.useCallback)(function(e){if(e.trim()){var r=e.trim(),n=[r].concat((0,o._)(t.recentSearches.filter(function(e){return e!==r}))).slice(0,10);a((0,i._)((0,s._)({},t),{recentSearches:n}))}},[t,a]),d=(0,l.useCallback)(function(){a((0,i._)((0,s._)({},t),{recentSearches:[]}))},[t,a]),f=(0,l.useCallback)(function(e,r,n){var l={id:`custom-${Date.now()}`,name:e.trim(),description:r.trim(),filters:{searchTerm:n.searchTerm,dateRange:n.dateRange,tags:(0,o._)(n.tags),sortBy:n.sortBy,sortDirection:n.sortDirection,fileFilter:n.fileFilter},createdAt:new Date().toISOString(),usageCount:0},c=[l].concat((0,o._)(t.customPresets.filter(function(t){return t.name!==e.trim()}))).slice(0,20);return a((0,i._)((0,s._)({},t),{customPresets:c})),l.id},[t,a]),m=(0,l.useCallback)(function(e){var r=t.customPresets.filter(function(t){return t.id!==e});a((0,i._)((0,s._)({},t),{customPresets:r}))},[t,a]),h=(0,l.useCallback)(function(e){var r=t.customPresets.map(function(t){return t.id===e?(0,i._)((0,s._)({},t),{usageCount:t.usageCount+1}):t});a((0,i._)((0,s._)({},t),{customPresets:r}))},[t,a]),g=(0,l.useCallback)(function(e){var r=(0,i._)((0,s._)({},t.filterUsageStats),{[e]:(t.filterUsageStats[e]||0)+1});a((0,i._)((0,s._)({},t),{filterUsageStats:r}))},[t,a]),v=(0,l.useCallback)(function(){return Object.entries(t.filterUsageStats).sort(function(e,t){var r=(0,n._)(e,2)[1];return(0,n._)(t,2)[1]-r}).slice(0,5).map(function(e){var t=(0,n._)(e,2);return{filter:t[0],count:t[1]}})},[t.filterUsageStats]),p=(0,l.useCallback)(function(){return(0,o._)(t.customPresets).sort(function(e,t){return t.usageCount-e.usageCount}).slice(0,5)},[t.customPresets]),x=(0,l.useCallback)(function(){var e=new Blob([JSON.stringify((0,i._)((0,s._)({},t),{exportedAt:new Date().toISOString(),version:"1.0"}),null,2)],{type:"application/json"}),r=URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=`bookmark-filter-history-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)},[t]),j=(0,l.useCallback)(function(e){return new Promise(function(r){var i=new FileReader;i.onload=function(e){try{var i,n=JSON.parse(null==(i=e.target)?void 0:i.result);if(n.recentSearches&&n.customPresets){var l={recentSearches:(0,o._)(t.recentSearches).concat((0,o._)(n.recentSearches||[])).slice(0,10),customPresets:(0,o._)(t.customPresets).concat((0,o._)(n.customPresets||[])).slice(0,20),filterUsageStats:(0,s._)({},t.filterUsageStats,n.filterUsageStats||{})};a(l),r(!0)}else r(!1)}catch(e){console.error("Error importing filter history:",e),r(!1)}},i.readAsText(e)})},[t,a]),S=(0,l.useCallback)(function(){a({recentSearches:[],customPresets:[],filterUsageStats:{}})},[a]);return{recentSearches:t.recentSearches,customPresets:t.customPresets,filterUsageStats:t.filterUsageStats,addRecentSearch:u,clearRecentSearches:d,saveFilterPreset:f,deleteFilterPreset:m,incrementPresetUsage:h,trackFilterUsage:g,getMostUsedFilters:v,getPopularPresets:p,exportHistory:x,importHistory:j,clearAllHistory:S}}})}();
//# sourceMappingURL=window.47d1104c.js.map
